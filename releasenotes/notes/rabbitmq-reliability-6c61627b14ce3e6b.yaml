---
prelude: >
    Reliability and performance improvements for the general rabbitmq
    broker configuration.  The adjustments solve or prevent potential
    problems for the performance and reliability of the RabbitMQ Broker.
    The changes are designed so that all types of queues used for
    Openstack should benefit from them.
features:
  - |
    - Allow to set the net_ticktime (https://www.rabbitmq.com/nettick.html)
      for faster detection of unavailable or broken nodes.
      (default value is the standard rabbitmq default of 60 seconds)
      It is recommended to the set the parameter "rabbitmq_net_ticktime"
      to 10 seconds, but this requires a sequential restart of all RabbitMQ
      brokers.
fixes:
  - |
    - increase the default of 2 elang nesia table loaders to 20 for faster
      startup times of the brokers
    - change the default behavior of the rabbitmq erlang scheduler-to-core
      binding back to the erlang default, make it more suitable for mixed
      wokloads on nodes
    - fix rabbitmq memory sizing to enable flow-control in
      a meaningful way (the previous scenarion assumed that to high amount
      of node memory can be used by rabbitmq)
    - configure a disk free limit to ensure that there is enough memory to
      persist messages
    - configure queue_leader_locator to be "client-local" for
      queues that are still not quorum queues
upgrade:
  - |
    - It is recommended to set the parameter "rabbitmq_net_ticktime" to
      10 seconds, (the future default, for faster detection of unavailable
      or broken nodes) but this requires a sequential restart of all
      RabbitMQ brokers.
